!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){d3.floorplan=function(){function a(){return this}var b=[],c=!0,d=5,e=95,f=d3.scaleLinear(),g=d3.scaleLinear();return a.xScale=function(c){return arguments.length?(f=c,b.forEach(function(a){a.xScale(f)}),a):f},a.yScale=function(c){return arguments.length?(g=c,b.forEach(function(a){a.yScale(g)}),a):g},a.maxZoom=function(b){return arguments.length?(d=b,a):d},a.layersWidth=function(b){return arguments.length?(e=b,a):e},a.panZoom=function(b){return arguments.length?(c=b,a):c},a.addLayer=function(c,d){return c.xScale(f),c.yScale(g),arguments.length>1&&d>=0?b.splice(d,0,c):b.push(c),a},a.imageLayers=function(a,b){a.selectAll("g.images").data(b).enter().append("g").attr("class",function(a){return"floor-"+a.id}).append("image").attr("xlink:href",function(a){return a.image.url}).attr("x",function(a){return a.image.x}).attr("y",function(a){return a.image.y}).attr("width",function(a){return a.image.w}).attr("height",function(a){return a.image.h})},a.drawText=function(a,b){var c=a.selectAll("text").data(b);c.attr("class","update"),c.enter().append("text").attr("class","enter").attr("x",function(a,b){return 32*b}).attr("dy",".35em").merge(c).text(function(a){return a}),c.exit().remove()},a.zonePolygons=function(a,b){var c=[{title:"Change zone name",action:function(a,b,c){console.log("Change zone name"),zone.name=prompt("Please enter new name name","Zone name"),d3.select("."+this.classList.item(1)+"-text").text(zone.name)}},{title:"Delete zone",action:function(a,b,c){console.log("You have deleted - "+this.classList.item(1)),d3.select("."+this.classList.item(1)).remove()}}];b.forEach(function(b){function d(a,b){var d=b.points;d3.select("g.outline").remove(),g=a.append("g").classed("polygon",!0).classed("zone-"+b.id,!0);for(var h=d3.drag().on("drag",e),i=g.append("polygon").attr("points",d),j=0;j<d.length;j++)g.append("circle").attr("cx",d[j][0]).attr("cy",d[j][1]).attr("r",4).call(h);var k=i._groups[0][0].getBBox();g._groups[0][0].getBBox();k.x=0,k.y=0,k.width=50,k.height=50,g.datum({x:0,y:0}),g.attr("transform",function(a){return"translate("+a.x+","+a.y+")"}),g.call(d3.drag().on("drag",function(a){d3.select(this).attr("transform","translate("+(a.x=d3.event.x)+","+(a.y=d3.event.y)+")")})),g.on("contextmenu",d3.contextMenu(c));var l=d3.polygonCentroid(d);f(b.name,l,"zone-"+b.id+"-text")}function e(){var a=[],c=d3.select(this),d=d3.select(this.parentNode),e=d3.select(this.parentNode).selectAll("circle"),g=d3.select(this.parentNode).select("polygon"),i=d3.event.x,j=d3.event.y;c.attr("cx",i).attr("cy",j);for(var k=0;k<h.length;k++){var l=d3.select(e._groups[0][k]),m=[parseInt(l.attr("cx")),parseInt(l.attr("cy"))];a[k]=m}g.attr("points",a),b.points=a,d3.select(".polygon-id-"+b.id+"-text").remove();var n=d3.polygonCentroid(a);f(b.name,n,"polygon-id-"+b.id+"-text"),bbox=d._groups[0][0].getBBox(),console.log(bbox)}function f(a,b,c){var d=g.append("text");d.attr("x",b[0]).attr("y",b[1]).attr("font-size",14).attr("font-weight",400).attr("font-family","sans-serif").attr("text-anchor","middle").style("fill","darkOrange").classed(c,!0),d.text(a)}var g,h=b.points;d(a,b)})},a.drawZonePolygon=function(a,b){function c(){if(!p){o=!0;var a=d3.mouse(this);i={x:a[0],y:a[1]},q.push(a);n.append("circle").attr("cx",i.x).attr("cy",i.y).attr("r",4).attr("start-point",!0).classed("handle",!0).style("cursor","pointer");d3.event.target.hasAttribute("handle")&&f()}}function d(){o&&(j=d3.mouse(this),n.select("line").remove(),n.append("line").attr("x1",i.x).attr("y1",i.y).attr("x2",j[0]-2).attr("y2",j[1]-2))}function e(){n.select("line").remove(),n.select("polyline").remove();n.append("polyline").attr("points",q);n.selectAll("circle").remove();for(var a=0;a<q.length;a++){n.append("circle").attr("cx",q[a][0]).attr("cy",q[a][1]).attr("r",5).attr("handle",!0).classed("handle",!0)}}function f(){d3.select("g.outline").remove(),l=a.append("g").classed("polygon",!0).classed("zone-"+b.id,!0),q.splice(q.length-1),polyEl=l.append("polygon").attr("points",q);for(var c=0;c<q.length;c++)l.append("circle").attr("cx",q[c][0]).attr("cy",q[c][1]).attr("r",4).call(r);o=!1,p=!0,k=polyEl._groups[0][0].getBBox();l._groups[0][0].getBBox();k.x=0,k.y=0,k.width=50,k.height=50,l.datum({x:0,y:0}),l.attr("transform",function(a){return"translate("+a.x+","+a.y+")"}),l.call(d3.drag().on("drag",function(a){d3.select(this).attr("transform","translate("+(a.x=d3.event.x)+","+(a.y=d3.event.y)+")")})),l.on("contextmenu",d3.contextMenu(m));var d=d3.polygonCentroid(q);g(l,b.name,d)}function g(a,c,d){var e=a.append("text");e.attr("x",d[0]).attr("y",d[1]).attr("font-size",14).attr("font-weight",400).attr("font-family","sans-serif").attr("text-anchor","middle").style("fill","darkOrange").classed("zone-"+b.id+"-text",!0),e.text(c)}function h(){if(!0!==o){var a=[],c=d3.select(this),d=d3.select(this.parentNode),e=d3.select(this.parentNode).selectAll("circle"),f=d3.select(this.parentNode).select("polygon"),h=d3.event.x,i=d3.event.y;c.attr("cx",h).attr("cy",i);for(var j=0;j<q.length;j++){var m=d3.select(e._groups[0][j]),n=[parseInt(m.attr("cx")),parseInt(m.attr("cy"))];a[j]=n}f.attr("points",a),b.points=a,d3.select(".zone-"+b.id+"-text").remove();var p=d3.polygonCentroid(a);g(l,b.name,p),k=d._groups[0][0].getBBox(),console.log(k)}}var i,j,k,l,m=[{title:"Change zone name",action:function(a,c,d){console.log("Change zone name"),b.name=prompt("Please enter new name name","Zone name"),d3.select("."+this.classList.item(1)+"-text").text(b.name)}},{title:"Delete zone",action:function(a,b,c){console.log("You have deleted - "+this.classList.item(1)),d3.select("."+this.classList.item(1)).remove()}}],n=a.append("g").classed("outline",!0),o=!1,p=!1,q=b.points,r=(a.on("mousedown",c).on("mousemove",d).on("mouseup",e),d3.drag().on("drag",h))},a.sensorImageLayer=function(a,b,c){var d=[{title:"Delete sensor",action:function(a,b,c){console.log("You have deleted - "+this.classList.item(1)),d3.select("."+this.classList.item(0)).remove()}}];a.selectAll(".floor-"+b.id).attr("class","floor-"+b.id+" update");var e=a.append("g").classed("sensor-"+c.id,!0),f=e.append("image").attr("xlink:href",c.url).attr("x",c.x).attr("y",c.y).attr("width",c.w).attr("height",c.h);e.datum({x:0,y:0}),e.attr("transform",function(a){return"translate("+a.x+","+a.y+")"}),d3.selectAll(".sensor-"+c.id).call(d3.drag().on("drag",function(a){d3.select(this).attr("transform","translate("+(a.x=d3.event.x)+","+(a.y=d3.event.y)+")")})),f.on("contextmenu",d3.contextMenu(d))},a},d3.floorplan.version="0.1.0"},{}],2:[function(a,b,c){var d=a("./floorplan");b.exports=d},{"./floorplan":1}]},{},[2]);